/* automatically generated by JSCoverage - do not edit */
try {
  if (typeof top === 'object' && top !== null && typeof top.opener === 'object' && top.opener !== null) {
    // this is a browser window that was opened from another window

    if (! top.opener._$jscoverage) {
      top.opener._$jscoverage = {};
    }
  }
}
catch (e) {}

try {
  if (typeof top === 'object' && top !== null) {
    // this is a browser window

    try {
      if (typeof top.opener === 'object' && top.opener !== null && top.opener._$jscoverage) {
        top._$jscoverage = top.opener._$jscoverage;
      }
    }
    catch (e) {}

    if (! top._$jscoverage) {
      top._$jscoverage = {};
    }
  }
}
catch (e) {}

try {
  if (typeof top === 'object' && top !== null && top._$jscoverage) {
    _$jscoverage = top._$jscoverage;
  }
}
catch (e) {}
if (typeof _$jscoverage !== 'object') {
  _$jscoverage = {};
}
if (! _$jscoverage['requestHandlers.js']) {
  _$jscoverage['requestHandlers.js'] = [];
  _$jscoverage['requestHandlers.js'][1] = 0;
  _$jscoverage['requestHandlers.js'][4] = 0;
  _$jscoverage['requestHandlers.js'][5] = 0;
  _$jscoverage['requestHandlers.js'][6] = 0;
  _$jscoverage['requestHandlers.js'][8] = 0;
  _$jscoverage['requestHandlers.js'][9] = 0;
  _$jscoverage['requestHandlers.js'][12] = 0;
  _$jscoverage['requestHandlers.js'][13] = 0;
  _$jscoverage['requestHandlers.js'][14] = 0;
  _$jscoverage['requestHandlers.js'][15] = 0;
  _$jscoverage['requestHandlers.js'][17] = 0;
  _$jscoverage['requestHandlers.js'][18] = 0;
  _$jscoverage['requestHandlers.js'][21] = 0;
  _$jscoverage['requestHandlers.js'][26] = 0;
  _$jscoverage['requestHandlers.js'][30] = 0;
  _$jscoverage['requestHandlers.js'][31] = 0;
  _$jscoverage['requestHandlers.js'][32] = 0;
  _$jscoverage['requestHandlers.js'][33] = 0;
  _$jscoverage['requestHandlers.js'][34] = 0;
  _$jscoverage['requestHandlers.js'][38] = 0;
  _$jscoverage['requestHandlers.js'][42] = 0;
  _$jscoverage['requestHandlers.js'][43] = 0;
  _$jscoverage['requestHandlers.js'][44] = 0;
  _$jscoverage['requestHandlers.js'][45] = 0;
  _$jscoverage['requestHandlers.js'][46] = 0;
  _$jscoverage['requestHandlers.js'][50] = 0;
  _$jscoverage['requestHandlers.js'][54] = 0;
  _$jscoverage['requestHandlers.js'][55] = 0;
  _$jscoverage['requestHandlers.js'][56] = 0;
  _$jscoverage['requestHandlers.js'][57] = 0;
  _$jscoverage['requestHandlers.js'][59] = 0;
  _$jscoverage['requestHandlers.js'][63] = 0;
  _$jscoverage['requestHandlers.js'][67] = 0;
  _$jscoverage['requestHandlers.js'][68] = 0;
  _$jscoverage['requestHandlers.js'][69] = 0;
  _$jscoverage['requestHandlers.js'][70] = 0;
  _$jscoverage['requestHandlers.js'][72] = 0;
  _$jscoverage['requestHandlers.js'][76] = 0;
  _$jscoverage['requestHandlers.js'][80] = 0;
  _$jscoverage['requestHandlers.js'][81] = 0;
  _$jscoverage['requestHandlers.js'][82] = 0;
  _$jscoverage['requestHandlers.js'][83] = 0;
  _$jscoverage['requestHandlers.js'][85] = 0;
  _$jscoverage['requestHandlers.js'][89] = 0;
  _$jscoverage['requestHandlers.js'][93] = 0;
  _$jscoverage['requestHandlers.js'][94] = 0;
  _$jscoverage['requestHandlers.js'][95] = 0;
  _$jscoverage['requestHandlers.js'][96] = 0;
  _$jscoverage['requestHandlers.js'][97] = 0;
  _$jscoverage['requestHandlers.js'][101] = 0;
  _$jscoverage['requestHandlers.js'][105] = 0;
  _$jscoverage['requestHandlers.js'][106] = 0;
  _$jscoverage['requestHandlers.js'][107] = 0;
  _$jscoverage['requestHandlers.js'][108] = 0;
  _$jscoverage['requestHandlers.js'][109] = 0;
  _$jscoverage['requestHandlers.js'][113] = 0;
  _$jscoverage['requestHandlers.js'][117] = 0;
  _$jscoverage['requestHandlers.js'][118] = 0;
  _$jscoverage['requestHandlers.js'][119] = 0;
  _$jscoverage['requestHandlers.js'][120] = 0;
  _$jscoverage['requestHandlers.js'][121] = 0;
  _$jscoverage['requestHandlers.js'][125] = 0;
  _$jscoverage['requestHandlers.js'][129] = 0;
  _$jscoverage['requestHandlers.js'][131] = 0;
  _$jscoverage['requestHandlers.js'][132] = 0;
  _$jscoverage['requestHandlers.js'][133] = 0;
  _$jscoverage['requestHandlers.js'][134] = 0;
  _$jscoverage['requestHandlers.js'][135] = 0;
  _$jscoverage['requestHandlers.js'][136] = 0;
  _$jscoverage['requestHandlers.js'][138] = 0;
  _$jscoverage['requestHandlers.js'][141] = 0;
  _$jscoverage['requestHandlers.js'][146] = 0;
  _$jscoverage['requestHandlers.js'][151] = 0;
  _$jscoverage['requestHandlers.js'][152] = 0;
  _$jscoverage['requestHandlers.js'][156] = 0;
  _$jscoverage['requestHandlers.js'][157] = 0;
  _$jscoverage['requestHandlers.js'][158] = 0;
  _$jscoverage['requestHandlers.js'][159] = 0;
  _$jscoverage['requestHandlers.js'][160] = 0;
  _$jscoverage['requestHandlers.js'][164] = 0;
  _$jscoverage['requestHandlers.js'][165] = 0;
  _$jscoverage['requestHandlers.js'][166] = 0;
  _$jscoverage['requestHandlers.js'][167] = 0;
  _$jscoverage['requestHandlers.js'][168] = 0;
  _$jscoverage['requestHandlers.js'][172] = 0;
  _$jscoverage['requestHandlers.js'][173] = 0;
  _$jscoverage['requestHandlers.js'][174] = 0;
  _$jscoverage['requestHandlers.js'][175] = 0;
  _$jscoverage['requestHandlers.js'][176] = 0;
  _$jscoverage['requestHandlers.js'][180] = 0;
  _$jscoverage['requestHandlers.js'][181] = 0;
  _$jscoverage['requestHandlers.js'][182] = 0;
  _$jscoverage['requestHandlers.js'][183] = 0;
  _$jscoverage['requestHandlers.js'][186] = 0;
  _$jscoverage['requestHandlers.js'][189] = 0;
  _$jscoverage['requestHandlers.js'][190] = 0;
  _$jscoverage['requestHandlers.js'][191] = 0;
  _$jscoverage['requestHandlers.js'][192] = 0;
  _$jscoverage['requestHandlers.js'][193] = 0;
  _$jscoverage['requestHandlers.js'][194] = 0;
  _$jscoverage['requestHandlers.js'][195] = 0;
  _$jscoverage['requestHandlers.js'][196] = 0;
  _$jscoverage['requestHandlers.js'][197] = 0;
  _$jscoverage['requestHandlers.js'][198] = 0;
  _$jscoverage['requestHandlers.js'][199] = 0;
  _$jscoverage['requestHandlers.js'][200] = 0;
}
_$jscoverage['requestHandlers.js'].source = ["var db = require('./db');","","//Init headers to allow CORS","var headers = {};","headers[\"Access-Control-Allow-Origin\"] = \"*\";","headers[\"Access-Control-Allow-Methods\"] = \"POST, GET, OPTIONS\";","","function connectDB(response) {","    db.start(response);","}","","function register(response, urlParts){","    var expected = [\"user\",\"pw\",\"name\"];","    if (checkVars(urlParts, expected)) {","        db.regUser(response, urlParts.query[\"user\"], urlParts.query[\"pw\"], urlParts.query[\"name\"],","                   function(regOK){","                       if (regOK) {","                           sendOK(response, \"Congratulations! Your account has been successfully registred.\");","                       }","                       else {","                           sendOK(response, \"The username is already in use, please try another one!\");","                       }","                   });","    }","    else {","        badReq(response);","    }","}","","function login(response, urlParts){","    var expected = [\"user\",\"pw\"];","    if (checkVars(urlParts, expected)) {","        db.userLogin(response, urlParts.query[\"user\"], urlParts.query[\"pw\"], function(msg){","            sendOK(response, msg);","        });","    }","    else {","        badReq(response);","    }","}","","function logoff(response, urlParts){","    var expected = [\"user\"];","    if (checkVars(urlParts, expected)) {","        db.userLogoff(response, urlParts.query[\"user\"], function(msg){","            sendOK(response, msg);","        });","    }","    else {","        badReq(response);","    }","}","","function showProfile(response, urlParts){","    var expected = [\"user\",\"target\"];","    if (checkVars(urlParts, expected)) {","        db.getProfile(response, urlParts.query[\"user\"], urlParts.query[\"target\"],","                      function(posts){","                          sendJson(response, posts);","                      });","    }","    else {","        badReq(response);","    }","}","","function post(response, urlParts){","    var expected = [\"user\",\"target\"];","    if (checkVars(urlParts, expected)) {","        db.addPost(response, urlParts.query['user'], urlParts.query['target'],","                   urlParts.query['text'], function(msg){","                       sendOK(response, msg);","                   });","    }","    else {","        badReq(response);","    }","}","","function add(response, urlParts){","    var expected = [\"user\",\"target\"];","    if (checkVars(urlParts, expected)) {","        db.addFriend(response, urlParts.query[\"user\"], urlParts.query[\"target\"],","                     function(msg){","                         sendOK(response, msg);","                     });","    }","    else {","        badReq(response);","    }","}","","function friends(response, urlParts){","    var expected = [\"user\"];","    if (checkVars(urlParts, expected)) {","        db.getFriends(response, urlParts.query[\"user\"], function(friendList){","            sendJson(response, friendList);","        });","    }","    else {","        badReq(response);","    }","}","","function onlineFriends(response, urlParts){","    var expected = [\"user\"];","    if (checkVars(urlParts, expected)) {","        db.getOnlineFriends(response, urlParts.query[\"user\"], function(friendsOnline){","            sendJson(response, friendsOnline);","        });","    }","    else {","        badReq(response);","    }","}","","function search(response, urlParts){","    var expected = [\"q\"];","    if (checkVars(urlParts, expected)) {","        db.searchUser(response, urlParts.query[\"q\"], function(result){","            sendJson(response, result);","        });","    }","    else {","        badReq(response);","    }","}","","var fs = require('fs');","","function getTemplate(response, urlParts){","    var expected = [\"template\"];","    if (checkVars(urlParts, expected)) {","        var templ = urlParts.query[\"template\"];","        fs.readFile('./templates/' + templ + '.html', function(err, html){","            if(err){","                //Requested template not found","                badReq(response);","            }","            else {","                sendOK(response, html.toString());","            }","        });","    }","    else {","        badReq(response);","    }","}","","//Used to set the user to inactive for chat-usage","function chatDC(userName){","    db.userDisconnect(userName);","}","","//200 OK with msg","function sendOK(response, msg){","    headers['Content-Type'] = 'text/html';","    response.writeHead(200, headers);","    response.write(msg);","    response.end();","}","","//200 OK with json","function sendJson(response, json){","    headers['Content-Type'] = 'application/json';","    response.writeHead(200, headers);","    response.write(JSON.stringify(json));","    response.end();","}","","//400 Bad Request","function badReq(response){","    headers['Content-Type'] = 'text/html';","    response.writeHead(400, headers);","    response.write(\"400 Bad Request\");","    response.end();","}","","//Check so the arguments match the expected variables","function checkVars(urlParts, expected) {","    for(var index in expected) {","        if (urlParts.query[expected[index]] == null) {","            return false;","        }","    }","    return true;","}","","exports.connectDB = connectDB;","exports.register = register;","exports.login = login;","exports.logoff = logoff;","exports.post = post;","exports.showProfile = showProfile;","exports.add = add;","exports.friends = friends;","exports.onlineFriends = onlineFriends;","exports.search = search;","exports.getTemplate = getTemplate;","exports.chatDC = chatDC;"];
_$jscoverage['requestHandlers.js'][1]++;
var db = require("./db");
_$jscoverage['requestHandlers.js'][4]++;
var headers = {};
_$jscoverage['requestHandlers.js'][5]++;
headers["Access-Control-Allow-Origin"] = "*";
_$jscoverage['requestHandlers.js'][6]++;
headers["Access-Control-Allow-Methods"] = "POST, GET, OPTIONS";
_$jscoverage['requestHandlers.js'][8]++;
function connectDB(response) {
  _$jscoverage['requestHandlers.js'][9]++;
  db.start(response);
}
_$jscoverage['requestHandlers.js'][12]++;
function register(response, urlParts) {
  _$jscoverage['requestHandlers.js'][13]++;
  var expected = ["user", "pw", "name"];
  _$jscoverage['requestHandlers.js'][14]++;
  if (checkVars(urlParts, expected)) {
    _$jscoverage['requestHandlers.js'][15]++;
    db.regUser(response, urlParts.query.user, urlParts.query.pw, urlParts.query.name, (function (regOK) {
  _$jscoverage['requestHandlers.js'][17]++;
  if (regOK) {
    _$jscoverage['requestHandlers.js'][18]++;
    sendOK(response, "Congratulations! Your account has been successfully registred.");
  }
  else {
    _$jscoverage['requestHandlers.js'][21]++;
    sendOK(response, "The username is already in use, please try another one!");
  }
}));
  }
  else {
    _$jscoverage['requestHandlers.js'][26]++;
    badReq(response);
  }
}
_$jscoverage['requestHandlers.js'][30]++;
function login(response, urlParts) {
  _$jscoverage['requestHandlers.js'][31]++;
  var expected = ["user", "pw"];
  _$jscoverage['requestHandlers.js'][32]++;
  if (checkVars(urlParts, expected)) {
    _$jscoverage['requestHandlers.js'][33]++;
    db.userLogin(response, urlParts.query.user, urlParts.query.pw, (function (msg) {
  _$jscoverage['requestHandlers.js'][34]++;
  sendOK(response, msg);
}));
  }
  else {
    _$jscoverage['requestHandlers.js'][38]++;
    badReq(response);
  }
}
_$jscoverage['requestHandlers.js'][42]++;
function logoff(response, urlParts) {
  _$jscoverage['requestHandlers.js'][43]++;
  var expected = ["user"];
  _$jscoverage['requestHandlers.js'][44]++;
  if (checkVars(urlParts, expected)) {
    _$jscoverage['requestHandlers.js'][45]++;
    db.userLogoff(response, urlParts.query.user, (function (msg) {
  _$jscoverage['requestHandlers.js'][46]++;
  sendOK(response, msg);
}));
  }
  else {
    _$jscoverage['requestHandlers.js'][50]++;
    badReq(response);
  }
}
_$jscoverage['requestHandlers.js'][54]++;
function showProfile(response, urlParts) {
  _$jscoverage['requestHandlers.js'][55]++;
  var expected = ["user", "target"];
  _$jscoverage['requestHandlers.js'][56]++;
  if (checkVars(urlParts, expected)) {
    _$jscoverage['requestHandlers.js'][57]++;
    db.getProfile(response, urlParts.query.user, urlParts.query.target, (function (posts) {
  _$jscoverage['requestHandlers.js'][59]++;
  sendJson(response, posts);
}));
  }
  else {
    _$jscoverage['requestHandlers.js'][63]++;
    badReq(response);
  }
}
_$jscoverage['requestHandlers.js'][67]++;
function post(response, urlParts) {
  _$jscoverage['requestHandlers.js'][68]++;
  var expected = ["user", "target"];
  _$jscoverage['requestHandlers.js'][69]++;
  if (checkVars(urlParts, expected)) {
    _$jscoverage['requestHandlers.js'][70]++;
    db.addPost(response, urlParts.query.user, urlParts.query.target, urlParts.query.text, (function (msg) {
  _$jscoverage['requestHandlers.js'][72]++;
  sendOK(response, msg);
}));
  }
  else {
    _$jscoverage['requestHandlers.js'][76]++;
    badReq(response);
  }
}
_$jscoverage['requestHandlers.js'][80]++;
function add(response, urlParts) {
  _$jscoverage['requestHandlers.js'][81]++;
  var expected = ["user", "target"];
  _$jscoverage['requestHandlers.js'][82]++;
  if (checkVars(urlParts, expected)) {
    _$jscoverage['requestHandlers.js'][83]++;
    db.addFriend(response, urlParts.query.user, urlParts.query.target, (function (msg) {
  _$jscoverage['requestHandlers.js'][85]++;
  sendOK(response, msg);
}));
  }
  else {
    _$jscoverage['requestHandlers.js'][89]++;
    badReq(response);
  }
}
_$jscoverage['requestHandlers.js'][93]++;
function friends(response, urlParts) {
  _$jscoverage['requestHandlers.js'][94]++;
  var expected = ["user"];
  _$jscoverage['requestHandlers.js'][95]++;
  if (checkVars(urlParts, expected)) {
    _$jscoverage['requestHandlers.js'][96]++;
    db.getFriends(response, urlParts.query.user, (function (friendList) {
  _$jscoverage['requestHandlers.js'][97]++;
  sendJson(response, friendList);
}));
  }
  else {
    _$jscoverage['requestHandlers.js'][101]++;
    badReq(response);
  }
}
_$jscoverage['requestHandlers.js'][105]++;
function onlineFriends(response, urlParts) {
  _$jscoverage['requestHandlers.js'][106]++;
  var expected = ["user"];
  _$jscoverage['requestHandlers.js'][107]++;
  if (checkVars(urlParts, expected)) {
    _$jscoverage['requestHandlers.js'][108]++;
    db.getOnlineFriends(response, urlParts.query.user, (function (friendsOnline) {
  _$jscoverage['requestHandlers.js'][109]++;
  sendJson(response, friendsOnline);
}));
  }
  else {
    _$jscoverage['requestHandlers.js'][113]++;
    badReq(response);
  }
}
_$jscoverage['requestHandlers.js'][117]++;
function search(response, urlParts) {
  _$jscoverage['requestHandlers.js'][118]++;
  var expected = ["q"];
  _$jscoverage['requestHandlers.js'][119]++;
  if (checkVars(urlParts, expected)) {
    _$jscoverage['requestHandlers.js'][120]++;
    db.searchUser(response, urlParts.query.q, (function (result) {
  _$jscoverage['requestHandlers.js'][121]++;
  sendJson(response, result);
}));
  }
  else {
    _$jscoverage['requestHandlers.js'][125]++;
    badReq(response);
  }
}
_$jscoverage['requestHandlers.js'][129]++;
var fs = require("fs");
_$jscoverage['requestHandlers.js'][131]++;
function getTemplate(response, urlParts) {
  _$jscoverage['requestHandlers.js'][132]++;
  var expected = ["template"];
  _$jscoverage['requestHandlers.js'][133]++;
  if (checkVars(urlParts, expected)) {
    _$jscoverage['requestHandlers.js'][134]++;
    var templ = urlParts.query.template;
    _$jscoverage['requestHandlers.js'][135]++;
    fs.readFile(("./templates/" + templ + ".html"), (function (err, html) {
  _$jscoverage['requestHandlers.js'][136]++;
  if (err) {
    _$jscoverage['requestHandlers.js'][138]++;
    badReq(response);
  }
  else {
    _$jscoverage['requestHandlers.js'][141]++;
    sendOK(response, html.toString());
  }
}));
  }
  else {
    _$jscoverage['requestHandlers.js'][146]++;
    badReq(response);
  }
}
_$jscoverage['requestHandlers.js'][151]++;
function chatDC(userName) {
  _$jscoverage['requestHandlers.js'][152]++;
  db.userDisconnect(userName);
}
_$jscoverage['requestHandlers.js'][156]++;
function sendOK(response, msg) {
  _$jscoverage['requestHandlers.js'][157]++;
  headers["Content-Type"] = "text/html";
  _$jscoverage['requestHandlers.js'][158]++;
  response.writeHead(200, headers);
  _$jscoverage['requestHandlers.js'][159]++;
  response.write(msg);
  _$jscoverage['requestHandlers.js'][160]++;
  response.end();
}
_$jscoverage['requestHandlers.js'][164]++;
function sendJson(response, json) {
  _$jscoverage['requestHandlers.js'][165]++;
  headers["Content-Type"] = "application/json";
  _$jscoverage['requestHandlers.js'][166]++;
  response.writeHead(200, headers);
  _$jscoverage['requestHandlers.js'][167]++;
  response.write(JSON.stringify(json));
  _$jscoverage['requestHandlers.js'][168]++;
  response.end();
}
_$jscoverage['requestHandlers.js'][172]++;
function badReq(response) {
  _$jscoverage['requestHandlers.js'][173]++;
  headers["Content-Type"] = "text/html";
  _$jscoverage['requestHandlers.js'][174]++;
  response.writeHead(400, headers);
  _$jscoverage['requestHandlers.js'][175]++;
  response.write("400 Bad Request");
  _$jscoverage['requestHandlers.js'][176]++;
  response.end();
}
_$jscoverage['requestHandlers.js'][180]++;
function checkVars(urlParts, expected) {
  _$jscoverage['requestHandlers.js'][181]++;
  for (var index in expected) {
    _$jscoverage['requestHandlers.js'][182]++;
    if ((urlParts.query[expected[index]] == null)) {
      _$jscoverage['requestHandlers.js'][183]++;
      return false;
    }
}
  _$jscoverage['requestHandlers.js'][186]++;
  return true;
}
_$jscoverage['requestHandlers.js'][189]++;
exports.connectDB = connectDB;
_$jscoverage['requestHandlers.js'][190]++;
exports.register = register;
_$jscoverage['requestHandlers.js'][191]++;
exports.login = login;
_$jscoverage['requestHandlers.js'][192]++;
exports.logoff = logoff;
_$jscoverage['requestHandlers.js'][193]++;
exports.post = post;
_$jscoverage['requestHandlers.js'][194]++;
exports.showProfile = showProfile;
_$jscoverage['requestHandlers.js'][195]++;
exports.add = add;
_$jscoverage['requestHandlers.js'][196]++;
exports.friends = friends;
_$jscoverage['requestHandlers.js'][197]++;
exports.onlineFriends = onlineFriends;
_$jscoverage['requestHandlers.js'][198]++;
exports.search = search;
_$jscoverage['requestHandlers.js'][199]++;
exports.getTemplate = getTemplate;
_$jscoverage['requestHandlers.js'][200]++;
exports.chatDC = chatDC;
